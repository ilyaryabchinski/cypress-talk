<!DOCTYPE html>
<html lang="en">
<head>
    <title>Shower Presentation Engine</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="shower/themes/material/styles/styles.css">
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
            --color-key: #16375A
        }
    </style>
</head>
<body class="shower list">

    <header class="caption">
        <h1>Cypress overview</h1>
    </header>

    <section class="slide" id="cover">
        <figure>
            <img class="cover" src="pictures/cypress-logo.png">
        </figure>
        <style>
            #cover h2 {
                margin: 30px 0 0;
                color: white;
                text-align: center;
                font-size: 70px;
            }

            #cover p {
                margin: 10px 0 0;
                text-align: center;
                color: white;
                font-style: italic;
                font-size: 20px;
            }

            #cover p a {
                color: white;
            }
        </style>
    </section>

    <section class="slide">
        <h2>Agenda</h2>
        <ol>
            <li>Cypress at a glance</li>
            <li>Differences from Selenium</li>
            <li>Core concepts & features</li>
            <li>How do we use Cypress</li>
            <li>Trade offs</li>
        </ol>
    </section>

    <section class="slide">
            <h2>Installing Cypress</h2>
            <pre>
                <code>npm install cypress --save-dev</code>
                <code>yarn add cypress --dev</code>
            </pre>
    </section>

    <section class="slide">
            <h2>Your first simple test</h2>
            <pre>
                    <code>describe('Post Resource', function() {</code>
                    <code>  it('Creating a New Post', function() {</code>
                    <code>    cy.visit('/posts/new')</code>
                    <code>    cy.get('input.post-title').type('My First Post')</code>  
                    <code>    cy.get('input.post-body').type('Hello, world!')</code>  
                    <code>    cy.contains('Submit').click() </code>  
                    <code>    cy.url().should('include', '/posts/my-first-post')</code>
                    <code>    cy.get('h1').should('contain', 'My First Post')</code>  
                    <code>  })</code>
                    <code>})</code>
            </pre>
    </section>

    <section class="slide">
            <h2>Running Cypress</h2>
            <pre>
                <code>npm run cypress:open</code>
                <code>yarn run cypress open</code>
                <code>npx cypress open</code>
            </pre>
    </section>

    <section class="slide" id="cover">
            <figure>
                <img class="cover" src="pictures/open.png">
            </figure>
        </section>

        <section class="slide">
            <h2>Differences from Selenium</h2>
            <ol>
                    <li>Behind Cypress is a Node.js server process</li>
                    <li>Cypress is executed in the same run loop as your application.</li>
                    <li>Cypress has native access to every single object</li>
                    <li>Cypress takes snapshots of your application</li>
                    <li>Stubbing network requests</li>
                    <li>Spying & Stubbing on DOM API</li>
                </ol>
        </section>

        <section class="slide">
                <h2>Querying elements</h2>
                <pre>
                    <code>cy.get('#element')</code>
                    <code>  .then(el => doSomethingAwesome(el))</code>
                </pre>
        </section>

        <section class="slide">
                <h2>Querying elements</h2>
                <pre>
                    <code>cy.get('.main').contains('New Post')</code>
                </pre>
        </section>

        <section class="slide">
            <h2>Commands</h2>
            <ul>
                <li>.blur() - Make a focused DOM element blur.</li>
                <li>.focus() - Focus on a DOM element.</li>
                <li>.clear() - Clear the value of an input or textarea.</li>
                <li>.check() - Check checkbox(es) or radio(s).</li>
                <li>.uncheck() - Uncheck checkbox(es).</li>
                <li>.select() - Select an &lt;option&gt; within a &lt;select&gt;.</li>
                <li>.dblclick() - Double-click a DOM element.</li>
            </ul>
        </section>

        <section class="slide">
            <h2>Assert</h2>
            <pre>
                <code>cy.get(':checkbox').should('be.disabled')</code>
            </pre>
        </section>

        <section class="slide">
            <h2>Aliases</h2>
            <pre>
                <code>beforeEach(function () {</code>
                <code>  cy.get('button').invoke('text').as('text')</code>    
                <code>})</code>    
                <code>it('has access to text', function () {</code>  
                <code>  this.text  <span class="comment">// is now available</span></code>  
                <code>})</code>
            </pre>
        </section>

        <section class="slide">
            <h2>Aliases</h2>
            <pre>
                <code>beforeEach(function () {</code>
                <code>  cy.get('table').find('tr').as('rows')</code>    
                <code>})</code>    
                <code>it('has access to rows', function () {</code>  
                <code>  this.rows  <span class="comment">// is now available</span></code>  
                <code>})</code>
            </pre>
        </section>

        <section class="slide">
            <h2>Aliases</h2>
            <pre>
                <code>cy.get('@rows').first().click()</code>
            </pre>
        </section>

        <section class="slide">
            <h2>Custom commands</h2>
            <pre>
                <code>Cypress.Commands.add("login", (email, password) => { ... })</code>
                <code><span class="comment">// somewhere in your test spec</span></code>
                <code>cy.login()</code>
            </pre>
        </section>

        <section class="slide" id="cover">
            <figure>
                <img class="cover" src="pictures/man.jpg">
            </figure>
    </section>

    <section class="slide">
        <h2>Folder structure</h2>
        <figure>
            <img src="pictures/structure.PNG">
        </figure>
        </div>
    </section>

    <section class="slide">
            <h2>Stub network requests</h2>
            <pre>
                    <code>cy.server();</code>
                    <code>cy.fixture('bioprocess/bioprocess-list').as('processes')</code>
                    <code>cy.route({</code>
                    <code>  method: 'GET',</code>
                    <code>  url: '/api/process-instances**',</code>
                    <code>  response: '@processes'</code>  
                    <code>}).as('getProcesses');</code>
            </pre>
    </section>

    <section class="slide">
            <h2>Selectors</h2>
            <pre>
                <code>const PROCESS_ITEM_ROW_SELECTOR = '.e2e-process-item-row';</code>
                <code>const STOP_BUTTON_SELECTOR = '.e2e-stop-button';</code>
                <code>const START_BUTTON_SELECTOR = '.e2e-start-button';</code>
            </pre>
            </div>
    </section>

    <section class="slide">
            <h2>Test case</h2>
            <pre>
                    <code>it('should search in process list', () => {</code>
                    <code>  const searchString = 'process';</code>
                    <code>  cy.wait('@getProcesses');</code>
                    <code>  cy.get(SEARCH_FIELD_SELECTOR).type(searchString);</code>
                    <code>  cy.wait('@getProcesses').then(xhr => {,</code>
                    <code>  expect(xhr.status).to.equal(200);</code>  
                    <code>  expect(xhr.url).to.contain(`search=${searchString}`);</code>
                    <code>  });</code>
                    <code>});</code>  
            </pre>
    </section>

    <section class="slide">
            <h2>Run the test!</h2>
            <pre>
                <code>npx cypress open</code>
            </pre>
    </section>

    <section class="slide" id="cover">
            <figure>
                <img class="cover" src="pictures/start.PNG">
            </figure>
    </section>

    <section class="slide" id="cover">
        <figure>
            <img class="cover" src="pictures/open1.png">
        </figure>
    </section>

    <section class="slide" id="cover">
            <figure>
                <img class="cover" src="pictures/snapshot.PNG">
            </figure>
    </section>

    <section class="slide">
            <h2>CI</h2>
            <pre>
                <code>http-server dist/qub-ui -c-1 -p 4200 --silent</code>
                <code>npx cypress verify</code>
                <code>npx cypress run</code>
            </pre>
    </section>

        <section class="slide">
            <h2>How does it works</h2>
            <ul>
                <li>Chains of commands</li>
                <li>Command queue</li>
                <li>Timeouts</li>
            </ul>
        </section>

        <section class="slide">
            <h2>Bundled libraries</h2>
            <ul>
                <li>Mocha</li>
                <li>Chai</li>
                <li>Sinon</li>
                <li>lodash</li>
                <li>jQuery</li>
                <li>minimatch</li>
                <li>moment</li>
                <li>Bluebird</li>
            </ul>
        </section>

        <section class="slide">
            <h2>Other features</h2>
            <ul>
                <li>Plugins</li>
                <li>Dashboard service</li>
                <li>Screenshots & video</li>
                <li>Server stub</li>
                <li>CI</li>
            </ul>
        </section>

    <section class="slide" id="cover">
            <figure>
                <img class="cover" src="pictures/arch.png">
            </figure>
    </section>


    <section class="slide">
            <h2>Issues</h2>
            <ul>
                <li>Can't store element in a variable</li>
                <li>throw new Error() for server errors simulating</li>
                <li>alert, confirm, file uploading</li>
                <li>Overlay elements</li>
            </ul>
    </section>

    <section class="slide">
            <h2>Permanent tradeoffs</h2>
            <ul>
                <li>Cypress is not a general purpose automation tool</li>
                <li>Cross-browser support</li>
                <li>Commands run inside of a browser</li>
                <li>There will never be support for multiple browser tabs</li>
                <li>You cannot use Cypress to drive two browsers at the same time</li>
                <li>Each test is bound to a single origin</li>
            </ul>
    </section>

    <section class="slide">
            <h2>Temporary tradeoffs</h2>
            <ul>
                <li>File uploads & downloads</li>
                <li>lack of commands like .tab() .hover() command</li>
                <li>iframe support is limited</li>
                <li>cy.route() for fetch (there is a workaround)</li>
                <li>Shadow DOM is not supported</li>
            </ul>
    </section>

    <section class="slide">
            <h2>Links</h2>
            <ul>
                <li><a href="https://docs.cypress.io/guides/overview/why-cypress.html#In-a-nutshell">Cypress docs</a></li>
                <li><a href="https://www.youtube.com/watch?v=5XQOK0v_YRE&t=1265s">Brian Mann – I see your point, but… (Part 1) - Assert(JS) 2018 </a></li>
                <li><a href="https://www.youtube.com/watch?v=GH9Dvo_BYkk&t=1s">Avoiding The Suck Of Testing Using Cypress.io</a></li>
            </ul>
    </section>

    <section class="slide">
            <h2 class="shout shrink">Thank you!</h2>
    </section>

    <div class="progress"></div>

    <script src="shower/shower.min.js"></script>
    <!-- Copyright © 3000 Yours Truly, Famous Inc. -->

</body>
</html>
